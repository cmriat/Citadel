[workspace]
name = "citadel_release"
version = "0.1.0"
description = "BOSä¸‹è½½å’ŒHDF5è½¬æ¢ç®¡ç†ç³»ç»Ÿ - æ”¯æŒWebç•Œé¢å’ŒCLIå·¥å…·"
channels = ["conda-forge"]
platforms = ["linux-64"]

[dependencies]
python = ">=3.10"
# åç«¯Webæ¡†æ¶
fastapi = ">=0.125.0"
uvicorn = ">=0.38.0"
python-multipart = ">=0.0.21"
# æ•°æ®å¤„ç†æ ¸å¿ƒä¾èµ–
h5py = ">=3.15.1,<4"
numpy = ">=1.24.0"
pyarrow = ">=22.0.0,<23"
pandas = ">=2.3.3,<3"
av = "*"
pillow = "*"
# å‘½ä»¤è¡Œå·¥å…·
tyro = "*"
termcolor = "*"
# ç³»ç»Ÿå·¥å…·
psutil = ">=5.9.0"
pydantic = ">=2.0.0"
# WebSocketæ”¯æŒ
websockets = "*"

[tasks]
# =============================================================================
# WebæœåŠ¡å™¨å¯åŠ¨ä»»åŠ¡
# =============================================================================

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆçƒ­é‡è½½ï¼‰
dev = "uvicorn backend.main:app --reload --host 0.0.0.0 --port 8000"

# å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
start = "uvicorn backend.main:app --host 0.0.0.0 --port 8000"

# =============================================================================
# CLIå·¥å…·ä»»åŠ¡ï¼ˆç‹¬ç«‹è¿è¡Œï¼Œä¸éœ€è¦WebæœåŠ¡å™¨ï¼‰
# =============================================================================

# ä¸‹è½½å·¥å…· - ä»BOSä¸‹è½½HDF5æ–‡ä»¶
# ç¤ºä¾‹: pixi run download --bos-path "srgdata/..." --local-path "/home/maozan/data/..."
download = "python -m cli.download_cli"

# è½¬æ¢å·¥å…· - æ‰¹é‡è½¬æ¢HDF5ä¸ºLeRobot v2.1æ ¼å¼
# ç¤ºä¾‹: pixi run convert --input-dir "/path/to/hdf5/" --output-dir "/path/to/output/"
convert = "python -m cli.convert_cli"

# ä¸Šä¼ å·¥å…· - ä¸Šä¼ LeRobotæ•°æ®åˆ°BOS
# ç¤ºä¾‹: pixi run upload --local-dir "./data/lerobot/" --bos-path "srgdata/robot/lerobot_data/"
upload = "python -m cli.upload_cli"

# åˆå¹¶å·¥å…· - åˆå¹¶å¤šä¸ªLeRobotæ•°æ®é›†ä¸ºä¸€ä¸ªæ•´ä½“
# ç¤ºä¾‹: pixi run merge --sources "./output1/" "./output2/" --output "./merged/"
merge = "python -m cli.merge_cli"

# =============================================================================
# æµ‹è¯•å’Œå¼€å‘å·¥å…·
# =============================================================================

# è¿è¡Œæ‰€æœ‰æµ‹è¯•
test = "pytest tests/ -v"

# å‰ç«¯æ„å»º
build-frontend = "cd frontend && npm install && npm run build"

# æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯
help = "echo '\nğŸ“¦ Citadel Release - ä½¿ç”¨æŒ‡å—\n\nğŸŒ Webæ¨¡å¼:\n  pixi run dev    - å¯åŠ¨å¼€å‘æœåŠ¡å™¨\n  pixi run start  - å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨\n\nâŒ¨ï¸  CLIæ¨¡å¼:\n  pixi run download  - BOSä¸‹è½½å·¥å…· (ä½¿ç”¨ --help æŸ¥çœ‹å‚æ•°)\n  pixi run convert   - HDF5è½¬æ¢å·¥å…· (ä½¿ç”¨ --help æŸ¥çœ‹å‚æ•°)\n  pixi run upload    - BOSä¸Šä¼ å·¥å…· (ä½¿ç”¨ --help æŸ¥çœ‹å‚æ•°)\n\nğŸ§ª å¼€å‘å·¥å…·:\n  pixi run test              - è¿è¡Œæµ‹è¯•\n  pixi run build-frontend    - æ„å»ºå‰ç«¯\n'"
